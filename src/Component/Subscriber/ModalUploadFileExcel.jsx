import { Modal, ScrollArea } from "@mantine/core";
import { useForm, Controller } from "react-hook-form";
import React, { useState, useEffect } from "react";
import UploadFileSubscriber from "./UploadFileSubscriber";
import { hideLoading, padNumber, showLoading } from "../../Utils/Utils";
import { all } from "axios";
import atob from "atob";
import * as XLSX from "xlsx";
import { template } from "lodash";
import ModelFail from "../Control/Modal/ModalFail";
import { message } from "antd";

export default function ModalUploadFileExcel(props) {
  const {
    // register,
    handleSubmit,
    resetField,
    setValue,
    control,
    formState: { errors },
  } = useForm();

  const {
    editStatus,
    onCloseModal,
    listData,
    allowcatedExcelFileList,
    setAllowcatedEnergyList,
    setAllowcatesExcelfileList,
    buttonTypeColor = "primary",
    yearStart,
    yearEnd,
    setIsShowFailModal,
    setMessageFailModal
  } = props;
  const [tumbFile, setTumbFile] = useState([]);
  

  const [templateFile, setTemplateFile] = useState({
    binary:
      "0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAANAAAAAAAAAAAEAAA/v///wAAAAD+////AAAAADMAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8JCBAAAAYFAFpPzQfJAAIABggAAOEAAgCwBMEAAgAAAOIAAABcAHAADwAAQmlyZCBVbmxvdmVhYmxlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEIAAgCwBGEBAgAAAMABAAA9AQIAAQCcAAIAEQAZAAIAAAASAAIAAAATAAIAAACvAQIAAAC8AQIAAAA9ABIA/3//f6hCTBQ4AAAAAAABAFgCQAACAAAAjQACAAAAIgACAAAADgACAAEAtwECAAAA2gACAAAAMQAoANwAAAAIAJABAAAAAgAADAFBAHAAdABvAHMAIABOAGEAcgByAG8AdwAxACgA3AAAAAgAkAEAAAACAAAMAUEAcAB0AG8AcwAgAE4AYQByAHIAbwB3ADEAKADcAAAACACQAQAAAAIAAAwBQQBwAHQAbwBzACAA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AAUAAgQAFAADAGVmBQAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAEgAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAGVmBgAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAEwAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAGVmBwAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAFAAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAGVmCAAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAFQAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAGVmCQAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAFgAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAMxMBAAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAFwAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAMxMBQAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAGAAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAMxMBgAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAGQAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAMxMBwAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAGgAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAMxMCAAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAGwAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADAMxMCQAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAHAAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADADIzBAAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAHQAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUAAgQAFAADADIzBQAAADtfKEBfKSAgfQhBAH0IAAAAAAAAAAAAAAAAHgAAAAMADQAUAAMAAAABAAAAMDBcKTtfKCoOAAUA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UEAPAADAUkAPAADAV0APAACAT0APAAAAU0APAAAATkAPAABgjEAOAP0ACgAFAAAADwASAAAAvQBaAAUAAQAPAACsn0APAACAUkAPAAAASUAPAACATUAPAACASUAPAABAUUAPAACAS0APAAAASkAPAACATUAPAAAAVEAPAACAS0APAAAAT0APAAAAUkAPAAAQh0AOAP0ACgAGAAAADwASAAAAvQBaAAYAAQAPAACwn0APAACAUUAPAABAUUAPAAAAWEAPAAAAU0APAAAATkAPAAAATkAPAAAATUAPAADAV0APAACATUAPAAAATEAPAADAVkAPAACAS0APAABoikAOAP0ACgAHAAAADwASAAAAvQBaAAcAAQAPAAC0n0APAAAAUkAPAACATkAPAAAATUAPAADAUEAPAAAATUAPAAAATUAPAAAAS0APAADAU0APAAAAVEAPAAAAV0APAACASUAPAADAU0APAABIiUAOAP0ACgAIAAAADwASAAAAvQBaAAgAAQAPAAC4n0APAACAT0APAACATkAPAAAAVkAPAACATEAPAADAVkAPAACAVEAPAACAVkAPAACATkAPAADAUUAPAACATEAPAACAVkAPAACAV0APAABIjEAOAP0ACgAJAAAADwASAAAAvQBaAAkAAQAPAAC8n0APAABAU0APAABAUUAPAADAUkAPAACASUAPAAAATUAPAAAAVUAPAABAVEAPAAAAS0APAAAAVUAPAADAUEAPAACAUEAPAADAUEAPAAAIikAOAP0ACgAKAAAADwASAAAAvQBaAAoAAQAPAADAn0APAACAVUAPAAAASUAPAABAUkAPAAAAWUAPAACAT0APAAAAWUAPAACAU0APAAAATkAPAABAVUAPAACAVUAPAACAUEAPAAAAT0APAABojEAOAP0ACgALAAAADwASAAAAvQBaAAsAAQAPAADEn0APAAAAVEAPAAAAT0APAAAAV0APAACAVkAPAADAU0APAACAV0APAABAVEAPAABAVEAPAACAWEAPAABAV0APAAAATUAPAACAVEAPAADwjkAOANcAHAAyBgAA3AA4ANIAbABsAGwAbABsAGwAbABsAGwAPgISALYGAAAAAEAAAAAAAAAADwAAAIsIEACLCAAAAAAAAAAAAAAAAAoAHQAPAAMBAAEAAAABAAEAAQABAWcIFwBnCAAAAAAAAAAAAAACAAH/////A0QAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/v8AAAoAAgAAAAAAAAAAAAAAAAAAAAAAAQAAAOCFn/L5T2gQq5EIACsns9kwAAAAlAAAAAYAAAABAAAAOAAAAAQAAABAAAAACAAAAFgAAAAMAAAAdAAAAA0AAACAAAAAEwAAAIwAAAACAAAAagMAAB4AAAAQAAAAQmlyZCBVbmxvdmVhYmxlAB4AAAAUAAAAV2FyYWRlZSBLT09OQ0hBSQAAAABAAAAAAJjydP/22gFAAAAAgCtnV5wN2wEDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP7/AAAKAAIAAAAAAAAAAAAAAAAAAAAAAAEAAAAC1c3VnC4bEJOXCAArLPmuMAAAAMgAAAAIAAAAAQAAAEgAAAAXAAAAUAAAAAsAAABYAAAAEAAAAGAAAAATAAAAaAAAABYAAABwAAAADQAAAHgAAAAMAAAApAAAAAIAAABqAwAAAwAAAAAAEAALAAAAAAAAAAsAAAAAAAAACwAAAAAAAAALAAAAAAAAAB4QAAABAAAAIAAAADIwMjQwODE2IENvbnRyYWN0IEVuZXJneSBBbW91bnQADBAAAAIAAAAeAAAACwAAAFdvcmtzaGVldHMAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAA/v///yQAAAAlAAAAJgAAACcAAAAoAAAAKQAAACoAAAD+////LAAAAC0AAAAuAAAALwAAADAAAAAxAAAAMgAAAP7////9/////v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUB//////////8CAAAAIAgCAAAAAADAAAAAAAAARgAAAAAAAAAAAAAAAAAAAAAAAAAA/v///wAAAAAAAAAAVwBvAHIAawBiAG8AbwBrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAgH///////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZEQAAAAAAAAFAFMAdQBtAG0AYQByAHkASQBuAGYAbwByAG0AYQB0AGkAbwBuAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAACAQEAAAADAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMAAAAAEAAAAAAAAAUARABvAGMAdQBtAGUAbgB0AFMAdQBtAG0AYQByAHkASQBuAGYAbwByAG0AYQB0AGkAbwBuAAAAAAAAAAAAAAA4AAIB////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKwAAAAAQAAAAAAAA",
    guid: "b8e5d0e0-61be-4a0d-9aab-a041622f387e",
    name: "Template ContractEnergyAmount.xls",
    type: "application/vnd.ms-excel",
  });

  function downloadTemplateFile() {
    const base64Content = templateFile.binary//.split(",")[1];
    const binaryString = atob(base64Content);
    const binaryLength = binaryString.length;
    const bytes = new Uint8Array(binaryLength);

    for (let i = 0; i < binaryLength; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }

    const blob = new Blob([bytes], { type: templateFile.type });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = templateFile.name;
    link.click();
    URL.revokeObjectURL(link.href);
  }

  console.log("Tumb File", tumbFile);
  const copytoMainFile = () => {
    console.log("FIle in Tumb to Main", allowcatedExcelFileList);
    setTumbFile([]);
    console.log(tumbFile);
  };

  const onClickCloseModal = () => {
    setTumbFile([]);
    onCloseModal();
  };

  const onClickOk = () => {
    console.log("Tumb File", tumbFile);
    console.log("function Ok in Modal");
    console.log("Tumb In UseEffect", tumbFile);
    console.log(tumbFile[0]?.guid);
    setAllowcatedEnergyList([])
    setAllowcatesExcelfileList((prevFileList) => {
      console.log("prevFileList", prevFileList);
      let newFileList = [
        {
          guid: tumbFile[0]?.guid,
          name: tumbFile[0]?.name,
          size: tumbFile[0]?.size,
          type: tumbFile[0]?.type,
          binary: tumbFile[0]?.binary,
        },
      ];
      return newFileList;
    });
    //copytoMainFile()
    console.log(allowcatedExcelFileList);
    //console.log(allowcatedExcelFileList[0].guid)
    //let base64String = allowcatedExcelFileList[0].binary;

    // Remove the header if present (e.g., 'data:application/vnd.ms-excel;base64,')
    const base64Content = tumbFile[0].binary//.split(",")[1];

    // Decode the base64 string to binary
    const binaryString = atob(base64Content);

    // Convert binary string to array buffer
    const len = binaryString.length;
    const bytes = new Uint8Array(len);
    for (let i = 0; i < len; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }

    // Convert array buffer to a binary string
    const arrayBuffer = bytes.buffer;

    // Read the Excel file using XLSX
    const workbook = XLSX.read(arrayBuffer, { type: "array" });

    // Access data from the first sheet
    const firstSheetName = workbook.SheetNames[0];
    const worksheet = workbook.Sheets[firstSheetName];
    const sheetData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

    // Log the sheet data
    //console.log(sheetData);
    checkCreate(sheetData)
    if (sheetData.length >= 3) {
      if(sheetData[1]?.[1] === "Year"||sheetData[1]?.[1] === "Year (A.D.)"){
        const filterYearSheet = sheetData.filter((items) => items[1] > 2100)
        const filterYearSheetEmpty = sheetData.filter((items) => items[1] === undefined)
        if(filterYearSheetEmpty.length === 0){
            if(filterYearSheet.length === 0){
              for(let i = 0;i < sheetData.length;i++){
                if(i>=2){
                  const filterDuplicate = sheetData.filter((items)=>items[1] === sheetData[i]?.[1])
                  if(filterDuplicate.length === 1){
                    if (listData.length === 0) {
                      console.log("Add new");
                      console.log("Items : ",sheetData[i]?.[2])
                      setAllowcatedEnergyList((prevEnergyList) => {
                        console.log("prevFileList", prevEnergyList);
                        let newFileList = [
                          ...prevEnergyList,
                          {
                            
                            allocateType: "CUSTOM",
                            amount01: Number(sheetData[i]?.[2] === undefined?0:isNaN(Number(sheetData[i]?.[2]))?0:sheetData[i]?.[2]%10 === 0?sheetData[i]?.[2]:sheetData[i]?.[2].toFixed(2)),
                            amount02: Number(sheetData[i]?.[3] === undefined?0:isNaN(Number(sheetData[i]?.[3]))?0:sheetData[i]?.[3]%10 === 0?sheetData[i]?.[3]:sheetData[i]?.[3].toFixed(2)),
                            amount03: Number(sheetData[i]?.[4] === undefined?0:isNaN(Number(sheetData[i]?.[4]))?0:sheetData[i]?.[4]%10 === 0?sheetData[i]?.[4]:sheetData[i]?.[4].toFixed(2)),
                            amount04: Number(sheetData[i]?.[5] === undefined?0:isNaN(Number(sheetData[i]?.[5]))?0:sheetData[i]?.[5]%10 === 0?sheetData[i]?.[5]:sheetData[i]?.[5].toFixed(2)),
                            amount05: Number(sheetData[i]?.[6] === undefined?0:isNaN(Number(sheetData[i]?.[6]))?0:sheetData[i]?.[6]%10 === 0?sheetData[i]?.[6]:sheetData[i]?.[6].toFixed(2)),
                            amount06: Number(sheetData[i]?.[7] === undefined?0:isNaN(Number(sheetData[i]?.[7]))?0:sheetData[i]?.[7]%10 === 0?sheetData[i]?.[7]:sheetData[i]?.[7].toFixed(2)),
                            amount07: Number(sheetData[i]?.[8] === undefined?0:isNaN(Number(sheetData[i]?.[8]))?0:sheetData[i]?.[8]%10 === 0?sheetData[i]?.[8]:sheetData[i]?.[8].toFixed(2)),
                            amount08: Number(sheetData[i]?.[9] === undefined?0:isNaN(Number(sheetData[i]?.[9]))?0:sheetData[i]?.[9]%10 === 0?sheetData[i]?.[9]:sheetData[i]?.[9].toFixed(2)),
                            amount09: Number(sheetData[i]?.[10] === undefined?0:isNaN(Number(sheetData[i]?.[10]))?0:sheetData[i]?.[10]%10 === 0?sheetData[i]?.[10]:sheetData[i]?.[10].toFixed(2)),
                            amount10: Number(sheetData[i]?.[11] === undefined?0:isNaN(Number(sheetData[i]?.[11]))?0:sheetData[i]?.[11]%10 === 0?sheetData[i]?.[11]:sheetData[i]?.[11].toFixed(2)),
                            amount11: Number(sheetData[i]?.[12] === undefined?0:isNaN(Number(sheetData[i]?.[12]))?0:sheetData[i]?.[12]%10 === 0?sheetData[i]?.[12]:sheetData[i]?.[12].toFixed(2)),
                            amount12: Number(sheetData[i]?.[13] === undefined?0:isNaN(Number(sheetData[i]?.[13]))?0:sheetData[i]?.[13]%10 === 0?sheetData[i]?.[13]:sheetData[i]?.[13].toFixed(2)),
                            year: Number(sheetData[i]?.[1]),
                          },
                        ];
                        return newFileList;
                      });
                    } else {
                      console.log("have data")
                      const lenghtFilter = listData.filter(
                        (items) => items.year === sheetData[i]?.[1]
                      );
                      //console.log(lenghtFilter)
                      if (lenghtFilter.length === 0) {
                        console.log("Add new Year");
                        setAllowcatedEnergyList((prevEnergyList) => {
                          console.log("prevFileList", prevEnergyList);
                          let newFileList = [
                            ...prevEnergyList,
                            {
                              allocateType: "CUSTOM",
                              amount01: Number(sheetData[i]?.[2] === undefined?0:isNaN(Number(sheetData[i]?.[2]))?0:sheetData[i]?.[2]%10 === 0?sheetData[i]?.[2]:sheetData[i]?.[2].toFixed(2)),
                              amount02: Number(sheetData[i]?.[3] === undefined?0:isNaN(Number(sheetData[i]?.[3]))?0:sheetData[i]?.[3]%10 === 0?sheetData[i]?.[3]:sheetData[i]?.[3].toFixed(2)),
                              amount03: Number(sheetData[i]?.[4] === undefined?0:isNaN(Number(sheetData[i]?.[4]))?0:sheetData[i]?.[4]%10 === 0?sheetData[i]?.[4]:sheetData[i]?.[4].toFixed(2)),
                              amount04: Number(sheetData[i]?.[5] === undefined?0:isNaN(Number(sheetData[i]?.[5]))?0:sheetData[i]?.[5]%10 === 0?sheetData[i]?.[5]:sheetData[i]?.[5].toFixed(2)),
                              amount05: Number(sheetData[i]?.[6] === undefined?0:isNaN(Number(sheetData[i]?.[6]))?0:sheetData[i]?.[6]%10 === 0?sheetData[i]?.[6]:sheetData[i]?.[6].toFixed(2)),
                              amount06: Number(sheetData[i]?.[7] === undefined?0:isNaN(Number(sheetData[i]?.[7]))?0:sheetData[i]?.[7]%10 === 0?sheetData[i]?.[7]:sheetData[i]?.[7].toFixed(2)),
                              amount07: Number(sheetData[i]?.[8] === undefined?0:isNaN(Number(sheetData[i]?.[8]))?0:sheetData[i]?.[8]%10 === 0?sheetData[i]?.[8]:sheetData[i]?.[8].toFixed(2)),
                              amount08: Number(sheetData[i]?.[9] === undefined?0:isNaN(Number(sheetData[i]?.[9]))?0:sheetData[i]?.[9]%10 === 0?sheetData[i]?.[9]:sheetData[i]?.[9].toFixed(2)),
                              amount09: Number(sheetData[i]?.[10] === undefined?0:isNaN(Number(sheetData[i]?.[10]))?0:sheetData[i]?.[10]%10 === 0?sheetData[i]?.[10]:sheetData[i]?.[10].toFixed(2)),
                              amount10: Number(sheetData[i]?.[11] === undefined?0:isNaN(Number(sheetData[i]?.[11]))?0:sheetData[i]?.[11]%10 === 0?sheetData[i]?.[11]:sheetData[i]?.[11].toFixed(2)),
                              amount11: Number(sheetData[i]?.[12] === undefined?0:isNaN(Number(sheetData[i]?.[12]))?0:sheetData[i]?.[12]%10 === 0?sheetData[i]?.[12]:sheetData[i]?.[12].toFixed(2)),
                              amount12: Number(sheetData[i]?.[13] === undefined?0:isNaN(Number(sheetData[i]?.[13]))?0:sheetData[i]?.[13]%10 === 0?sheetData[i]?.[13]:sheetData[i]?.[13].toFixed(2)),
                              year: Number(sheetData[i]?.[1]),
                            },
                          ];
                          return newFileList;
                        });
                      } else {
                        console.log("Update Old Data");
                        const indexFilterList = listData.findIndex(
                          (items) => items.year === sheetData[i]?.[1]
                        );
                        
                        const listTempData = listData;
                        //console.log("List Old",listTempData[indexFilterList])
                        
                        listTempData[indexFilterList] = {
                            allocateType: "CUSTOM",
                            amount01: Number(sheetData[i]?.[2] === undefined?0:isNaN(Number(sheetData[i]?.[2]))?0:sheetData[i]?.[2]%10 === 0?sheetData[i]?.[2]:sheetData[i]?.[2].toFixed(2)),
                            amount02: Number(sheetData[i]?.[3] === undefined?0:isNaN(Number(sheetData[i]?.[3]))?0:sheetData[i]?.[3]%10 === 0?sheetData[i]?.[3]:sheetData[i]?.[3].toFixed(2)),
                            amount03: Number(sheetData[i]?.[4] === undefined?0:isNaN(Number(sheetData[i]?.[4]))?0:sheetData[i]?.[4]%10 === 0?sheetData[i]?.[4]:sheetData[i]?.[4].toFixed(2)),
                            amount04: Number(sheetData[i]?.[5] === undefined?0:isNaN(Number(sheetData[i]?.[5]))?0:sheetData[i]?.[5]%10 === 0?sheetData[i]?.[5]:sheetData[i]?.[5].toFixed(2)),
                            amount05: Number(sheetData[i]?.[6] === undefined?0:isNaN(Number(sheetData[i]?.[6]))?0:sheetData[i]?.[6]%10 === 0?sheetData[i]?.[6]:sheetData[i]?.[6].toFixed(2)),
                            amount06: Number(sheetData[i]?.[7] === undefined?0:isNaN(Number(sheetData[i]?.[7]))?0:sheetData[i]?.[7]%10 === 0?sheetData[i]?.[7]:sheetData[i]?.[7].toFixed(2)),
                            amount07: Number(sheetData[i]?.[8] === undefined?0:isNaN(Number(sheetData[i]?.[8]))?0:sheetData[i]?.[8]%10 === 0?sheetData[i]?.[8]:sheetData[i]?.[8].toFixed(2)),
                            amount08: Number(sheetData[i]?.[9] === undefined?0:isNaN(Number(sheetData[i]?.[9]))?0:sheetData[i]?.[9]%10 === 0?sheetData[i]?.[9]:sheetData[i]?.[9].toFixed(2)),
                            amount09: Number(sheetData[i]?.[10] === undefined?0:isNaN(Number(sheetData[i]?.[10]))?0:sheetData[i]?.[10]%10 === 0?sheetData[i]?.[10]:sheetData[i]?.[10].toFixed(2)),
                            amount10: Number(sheetData[i]?.[11] === undefined?0:isNaN(Number(sheetData[i]?.[11]))?0:sheetData[i]?.[11]%10 === 0?sheetData[i]?.[11]:sheetData[i]?.[11].toFixed(2)),
                            amount11: Number(sheetData[i]?.[12] === undefined?0:isNaN(Number(sheetData[i]?.[12]))?0:sheetData[i]?.[12]%10 === 0?sheetData[i]?.[12]:sheetData[i]?.[12].toFixed(2)),
                            amount12: Number(sheetData[i]?.[13] === undefined?0:isNaN(Number(sheetData[i]?.[13]))?0:sheetData[i]?.[13]%10 === 0?sheetData[i]?.[13]:sheetData[i]?.[13].toFixed(2)),
                            year: Number(sheetData[i]?.[1]),
                        };
                        setAllowcatedEnergyList(listTempData);
                      }
                    }
                  }
                  else{
                    setIsShowFailModal(true)
                    setMessageFailModal("Please check file data again have year is duplicate.")
                    setAllowcatesExcelfileList([])
                    setTumbFile([]);
                    onCloseModal();
                    break;
                  }
                }
              }
            /*sheetData.map((item, index) => {
            if (index >= 2) {
              console.log("Items", item);
                if (listData.length === 0) {
                  console.log("Add new");
                  console.log("Items : ",item[2])
                  setAllowcatedEnergyList((prevEnergyList) => {
                    console.log("prevFileList", prevEnergyList);
                    let newFileList = [
                      ...prevEnergyList,
                      {
                        
                        allocateType: "CUSTOM",
                        amount01: Number(item[2] === undefined?0:isNaN(Number(item[2]))?0:item[2]%10 === 0?item[2]:item[2].toFixed(2)),
                        amount02: Number(item[3] === undefined?0:isNaN(Number(item[3]))?0:item[3]%10 === 0?item[3]:item[3].toFixed(2)),
                        amount03: Number(item[4] === undefined?0:isNaN(Number(item[4]))?0:item[4]%10 === 0?item[4]:item[4].toFixed(2)),
                        amount04: Number(item[5] === undefined?0:isNaN(Number(item[5]))?0:item[5]%10 === 0?item[5]:item[5].toFixed(2)),
                        amount05: Number(item[6] === undefined?0:isNaN(Number(item[6]))?0:item[6]%10 === 0?item[6]:item[6].toFixed(2)),
                        amount06: Number(item[7] === undefined?0:isNaN(Number(item[7]))?0:item[7]%10 === 0?item[7]:item[7].toFixed(2)),
                        amount07: Number(item[8] === undefined?0:isNaN(Number(item[8]))?0:item[8]%10 === 0?item[8]:item[8].toFixed(2)),
                        amount08: Number(item[9] === undefined?0:isNaN(Number(item[9]))?0:item[9]%10 === 0?item[9]:item[9].toFixed(2)),
                        amount09: Number(item[10] === undefined?0:isNaN(Number(item[10]))?0:item[10]%10 === 0?item[10]:item[10].toFixed(2)),
                        amount10: Number(item[11] === undefined?0:isNaN(Number(item[11]))?0:item[11]%10 === 0?item[11]:item[11].toFixed(2)),
                        amount11: Number(item[12] === undefined?0:isNaN(Number(item[12]))?0:item[12]%10 === 0?item[12]:item[12].toFixed(2)),
                        amount12: Number(item[13] === undefined?0:isNaN(Number(item[13]))?0:item[13]%10 === 0?item[13]:item[13].toFixed(2)),
                        year: Number(item[1]),
                      },
                    ];
                    return newFileList;
                  });
                } else {
                  console.log("have data")
                  const lenghtFilter = listData.filter(
                    (items) => items.year === item[1]
                  );
                  //console.log(lenghtFilter)
                  if (lenghtFilter.length === 0) {
                    console.log("Add new Year");
                    setAllowcatedEnergyList((prevEnergyList) => {
                      console.log("prevFileList", prevEnergyList);
                      let newFileList = [
                        ...prevEnergyList,
                        {
                          allocateType: "CUSTOM",
                          amount01: Number(item[2] === undefined?0:isNaN(Number(item[2]))?0:item[2]%10 === 0?item[2]:item[2].toFixed(2)),
                          amount02: Number(item[3] === undefined?0:isNaN(Number(item[3]))?0:item[3]%10 === 0?item[3]:item[3].toFixed(2)),
                          amount03: Number(item[4] === undefined?0:isNaN(Number(item[4]))?0:item[4]%10 === 0?item[4]:item[4].toFixed(2)),
                          amount04: Number(item[5] === undefined?0:isNaN(Number(item[5]))?0:item[5]%10 === 0?item[5]:item[5].toFixed(2)),
                          amount05: Number(item[6] === undefined?0:isNaN(Number(item[6]))?0:item[6]%10 === 0?item[6]:item[6].toFixed(2)),
                          amount06: Number(item[7] === undefined?0:isNaN(Number(item[7]))?0:item[7]%10 === 0?item[7]:item[7].toFixed(2)),
                          amount07: Number(item[8] === undefined?0:isNaN(Number(item[8]))?0:item[8]%10 === 0?item[8]:item[8].toFixed(2)),
                          amount08: Number(item[9] === undefined?0:isNaN(Number(item[9]))?0:item[9]%10 === 0?item[9]:item[9].toFixed(2)),
                          amount09: Number(item[10] === undefined?0:isNaN(Number(item[10]))?0:item[10]%10 === 0?item[10]:item[10].toFixed(2)),
                          amount10: Number(item[11] === undefined?0:isNaN(Number(item[11]))?0:item[11]%10 === 0?item[11]:item[11].toFixed(2)),
                          amount11: Number(item[12] === undefined?0:isNaN(Number(item[12]))?0:item[12]%10 === 0?item[12]:item[12].toFixed(2)),
                          amount12: Number(item[13] === undefined?0:isNaN(Number(item[13]))?0:item[13]%10 === 0?item[13]:item[13].toFixed(2)),
                          year: Number(item[1]),
                        },
                      ];
                      return newFileList;
                    });
                  } else {
                    console.log("Update Old Data");
                    const indexFilterList = listData.findIndex(
                      (items) => items.year === item[1]
                    );
                    
                    const listTempData = listData;
                    //console.log("List Old",listTempData[indexFilterList])
                    
                    listTempData[indexFilterList] = {
                      allocateType: "CUSTOM",
                      amount01: Number(item[2] === undefined?0:isNaN(Number(item[2]))?0:item[2]%10 === 0?item[2]:item[2].toFixed(2)),
                      amount02: Number(item[3] === undefined?0:isNaN(Number(item[3]))?0:item[3]%10 === 0?item[3]:item[3].toFixed(2)),
                      amount03: Number(item[4] === undefined?0:isNaN(Number(item[4]))?0:item[4]%10 === 0?item[4]:item[4].toFixed(2)),
                      amount04: Number(item[5] === undefined?0:isNaN(Number(item[5]))?0:item[5]%10 === 0?item[5]:item[5].toFixed(2)),
                      amount05: Number(item[6] === undefined?0:isNaN(Number(item[6]))?0:item[6]%10 === 0?item[6]:item[6].toFixed(2)),
                      amount06: Number(item[7] === undefined?0:isNaN(Number(item[7]))?0:item[7]%10 === 0?item[7]:item[7].toFixed(2)),
                      amount07: Number(item[8] === undefined?0:isNaN(Number(item[8]))?0:item[8]%10 === 0?item[8]:item[8].toFixed(2)),
                      amount08: Number(item[9] === undefined?0:isNaN(Number(item[9]))?0:item[9]%10 === 0?item[9]:item[9].toFixed(2)),
                      amount09: Number(item[10] === undefined?0:isNaN(Number(item[10]))?0:item[10]%10 === 0?item[10]:item[10].toFixed(2)),
                      amount10: Number(item[11] === undefined?0:isNaN(Number(item[11]))?0:item[11]%10 === 0?item[11]:item[11].toFixed(2)),
                      amount11: Number(item[12] === undefined?0:isNaN(Number(item[12]))?0:item[12]%10 === 0?item[12]:item[12].toFixed(2)),
                      amount12: Number(item[13] === undefined?0:isNaN(Number(item[13]))?0:item[13]%10 === 0?item[13]:item[13].toFixed(2)),
                      year: Number(item[1]),
                    };
                    setAllowcatedEnergyList(listTempData);
                  }
                }
            }
            });*/
            setTumbFile([]);
            onCloseModal();
            }
            else{
              //message.error("Please check file data is not match and try again.")
              setIsShowFailModal(true)
              setMessageFailModal("Please check file data is not match and try again.")
              setAllowcatesExcelfileList([])
              setTumbFile([]);
              onCloseModal();
            }
        }
        else{
          //message.error("Please check file data again year is empty.")
          setIsShowFailModal(true)
          setMessageFailModal("Please check file data again year is empty.")
          setAllowcatesExcelfileList([])
          setTumbFile([]);
          onCloseModal();
        }
        
      }
      else{
        //message.error("Please check file data is not match and try again.")
        setIsShowFailModal(true)
        setMessageFailModal("Please check file data is not match and try again.")
        setAllowcatesExcelfileList([])
        setTumbFile([]);
        onCloseModal();
      }
    } else {
      //message.error("This file didn't have data to add.");
      setIsShowFailModal(true)
      setMessageFailModal("This file didn't have data to add.")
    }
  };

  const checkCreate=(data)=>{
    console.log("Come to function check")
      const diffYear = (yearEnd-yearStart)+1
      const lengthData = data.length-2
      console.log("Data",data)
      const lengthCreateStartyear = data.filter((items)=> items[1] === yearStart)
      const lenghtCreateEndyear = data.filter((items)=>items[1] === yearEnd)
      console.log("Diff Year",diffYear)
      console.log("Data length",lengthData)
      console.log(lengthCreateStartyear.length)
      console.log(lenghtCreateEndyear.length)

      if(lengthCreateStartyear.length !== 0){
        console.log("Have Start Year")
        if(lenghtCreateEndyear.length !== 0){
          console.log("Have End Year")
          if(lengthData < diffYear){
            console.log("Length is not match")
            setIsShowFailModal(true)
            setMessageFailModal("Data upload file is not match with Retail ESA Contract Start Date and Retail ESA Contract End Date")
          }
        }
        else{
          console.log("Dont have end")
            setIsShowFailModal(true)
            setMessageFailModal("Data upload file is not match with Retail ESA Contract Start Date and Retail ESA Contract End Date")
        }
      }
      else{
        console.log("Dont have start")
        setIsShowFailModal(true)
        setMessageFailModal("Data upload file is not match with Retail ESA Contract Start Date and Retail ESA Contract End Date")
      }
  }

  const getButtonColor = () => {
    switch (buttonTypeColor) {
      case "primary":
        return "bg-[#87BE33]";
      case "danger":
        return "bg-[#EF4835]";

      default:
        return "bg-[#87BE33]";
    }
  };
  function generateGUID() {
    return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(
      /[xy]/g,
      function (c) {
        const r = (Math.random() * 16) | 0,
          v = c === "x" ? r : (r & 0x3) | 0x8;
        return v.toString(16);
      }
    );
  }

  const handleUploadfileExcel = async (id, result) => {
    // console.log("fileJaa>>>",file)
    console.log("Result", result);
    console.log("----Excel FIle---", allowcatedExcelFileList);
    console.log("Lenght Excel", allowcatedExcelFileList.length);
    console.log(id);
    const reader = new FileReader();
    reader.onload = function (e) {
      const arrayBuffer = e.target.result;
      
      console.log("Binary data as ArrayBuffer:", arrayBuffer);
      const base64Content = arrayBuffer.split(",")[1];
      console.log(base64Content)
      let guid = generateGUID();
      setTumbFile((prevFileList) => {
        console.log("prevFileList", prevFileList);
        let newFileList = [
          ...prevFileList,
          {
            guid: "",
            name: result?.name,
            size: result?.size,
            type: result?.type,
            binary: base64Content,
          },
        ];
        return newFileList;
      });
    };

    console.log(allowcatedExcelFileList);

    let bi = reader.readAsDataURL(result);

    /*console.log("id", id);
        console.log("res", result);
        console.log("file=>>", result?.res["@id"]);
    
        setFileListExcel((prevFileList) => {
          console.log("prevFileList", prevFileList);
          let newFileList = [
            ...prevFileList,
            { fileID: result?.res?.uid, evidentFileID: result?.res["@id"] },
          ];
          return newFileList;
        });*/
  };

  const handleDeleteFileExcel = (id, evidentFileID, fileName) => {
    // console.log('id>>',id)
    console.log("evidentFileID>>", evidentFileID);
    /*setAllowcatesExcelfileList((prevFileList) => {
      console.log("prevFileList", prevFileList);
      let newFileList = prevFileList.filter(
        (item) => item.name !== evidentFileID
      );
      return newFileList;
    });*/
    setTumbFile([])
  };

  const handleClickDownloadFileExcel = async (item) => {
    // console.log('item',item)
    // console.log('item evidentFileID',item?.evidentFileID)
    // console.log('item name',item?.name)
    try {
      // setIsOpenLoading(true);
      showLoading();
      console.log("Download File");
      const fileID = item?.guid;
      const fileName = item?.name;
      const binary = item?.binary;
      const requestParameter = {
        fileID: fileID,
        fileName: fileName,
      };
      //const response = await FetchDownloadFile(requestParameter);

      //const blob = new Blob([response.res.data], {
      //type: response.res.headers["content-type"],
      //});
      // Create a download link
      //const url = window.URL.createObjectURL(blob);
      //const a = document.createElement("a");
      //a.href = url;
      //a.download = fileName;
      //document.body.appendChild(a);
      //a.click();
      //document.body.removeChild(a);
      //window.URL.revokeObjectURL(url);
    } catch (error) {
      //  console.error("Error downloading file:", error);
    }
    hideLoading();
    // setIsOpenLoading(false);
  };

  return (
    <Modal
      size="xl"
      opened={true}
      onClose={() => onClickOk && onClickOk(false)}
      withCloseButton={false}
      closeOnClickOutside={false}
      centered
    >
      {/* <div className="pt-4 px-4 pb-2">
        <h6 className="text-PRIMARY_TEXT font-semibold">
          Allocated energy amount
        </h6>
        </div>*/}
      <Controller
        name="uploadFileExcel"
        control={control}
        rules={{
          required: "This field is required",
        }}
        render={({ field }) => (
          <UploadFileSubscriber
            {...field}
            id={"uploadFileExcel"}
            type={"file"}
            multiple={false}
            accept={".xls,.xlsx"}
            label={"Allocated energy amount"}
            onChngeInput={(id, res) => {
              handleUploadfileExcel(id, res);
            }}
            onDeleteFile={(id, evidentFileID, fileName) => {
              handleDeleteFileExcel(id, evidentFileID, fileName);
            }}
            onClickFile={(item) => {
              handleClickDownloadFileExcel(item);
            }}
            error={errors.uploadFileExcel}
            validate={" *"}
            disabled={tumbFile.length !== 0 ?true:false}
            // ... other props
          />
        )}
      />
      <div className="grow bg-lime-200 mt-2 w-full">
        <div className="flex justify-content items-center">
          <div className="mr-8"></div>
          <label className="text-sm font-normal">
            Download Template File :
          </label>
          <div>
            <label
              style={{ cursor: "pointer", color: "blue" }}
              className="text-sm font-normal ml-1"
              onClick={downloadTemplateFile}
            >
              {templateFile.name}
            </label>
          </div>
        </div>
      </div>
      <div className="flex justify-center gap-3 p-2 mt-4">
        <button
          onClick={onCloseModal}
          className="w-25 rounded shadow-sm px-4 py-2 font-normal bg-[#EFEFEF] hover:bg-[#78829D] hover:text-white"
        >
          Cancel
        </button>
        <button
          onClick={handleSubmit(onClickOk)}
          className={`${getButtonColor()} w-25 rounded shadow-sm px-4 py-2 font-semibold text-white sm:text-sm hover:bg-[#4D6A00] `}
        >
          Import
        </button>
      </div>
    </Modal>
  );
}
