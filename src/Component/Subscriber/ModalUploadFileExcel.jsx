import { Modal, ScrollArea } from "@mantine/core";
import { useForm, Controller } from "react-hook-form";
import React, { useState, useEffect } from "react";
import UploadFileSubscriber from "./UploadFileSubscriber";
import { hideLoading, padNumber, showLoading } from "../../Utils/Utils";
import { all } from "axios";
import atob from "atob";
import * as XLSX from "xlsx";
import { template } from "lodash";
import ModelFail from "../Control/Modal/ModalFail";
import { message } from "antd";

export default function ModalUploadFileExcel(props) {
  const {
    // register,
    handleSubmit,
    resetField,
    setValue,
    control,
    formState: { errors },
  } = useForm();

  const {
    editStatus,
    onCloseModal,
    listData,
    allowcatedExcelFileList,
    setAllowcatedEnergyList,
    setAllowcatesExcelfileList,
    buttonTypeColor = "primary",
    yearStart,
    yearEnd,
    setIsShowFailModal,
    setMessageFailModal
  } = props;
  const [tumbFile, setTumbFile] = useState([]);
  

  const [templateFile, setTemplateFile] = useState({
    binary:
      "0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAOQAAAAAAAAAAEAAA/v///wAAAAD+////AAAAADgAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8JCBAAAAYFAFpPzQfJAAIABggAAOEAAgCwBMEAAgAAAOIAAABcAHAACAAAa3VsbGFuaXQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEIAAgCwBGEBAgAAAMABAAA9AQIAAQCcAAIAEQAZAAIAAAASAAIAAAATAAIAAACvAQIAAAC8AQIAAAA9ABIA/3//fwBLEhs4AAAAAAABAFgCQAACAAAAjQACAAAAIgACAAAADgACAAEAtwECAAAA2gACAAAAMQAoANwAAAAIAJABAAAAAgAADAFBAHAAdABvAHMAIABOAGEAcgByAG8AdwAxACgA3AAAAAgAkAEAAAACAAAMAUEAcAB0AG8AcwAgAE4AYQByAHIAbwB3ADEAKADcAAAACACQAQAAAAIAAAwBQQBwAHQAbwBzACAA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QF8pICB9CEEAfQgAAAAAAAAAAAAAAAAaAAAAAwANABQAAwAAAAEAAAB5eXkpO18oKg4ABQACBAAUAAMAzEwIAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAbAAAAAwANABQAAwAAAAEAAAB5eXkpO18oKg4ABQACBAAUAAMAzEwJAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAcAAAAAwANABQAAwAAAAEAAAB5eXkpO18oKg4ABQACBAAUAAMAMjMEAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAdAAAAAwANABQAAwAAAAEAAAB5eXkpO18oKg4ABQACBAAUAAMAMjMFAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAeAAAAAwANABQAAwAAAAEAAAB5eXkpO18oKg4ABQACBAAUAAMAMjMGAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAfAAAAAwANABQAAwAAAAEAAAB5eXkpO18oKg4ABQACBAAUAAMAMjMHAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAgAAAAAwANABQAAwAAAAEAAAB5eXkpO18oKg4ABQACBAAUAAMAMjMIAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAhAAAAAwANABQAAwAAAAEAAAB5eXkpO18oKg4ABQACBAAUAAMAMjMJAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAiAAAAAwANABQAAwAAAAAAAAB5eXkpO18oKg4ABQACBAAUAAMAAAAEAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAjAAAAAwANABQAAwAAAAAAAAB5eXkpO18oKg4ABQACBAAUAAMAAAAFAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAkAAAAAwANABQAAwAAAAAAAAB5eXkpO18oKg4ABQACBAAUAAMAAAAGAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAlAAAAAwANABQAAwAAAAAAAAB5eXkpO18oKg4ABQACBAAUAAMAAAAHAAAAO18oQF8pICB9CEEAfQgAAAAAAAAAAAAAAAAmAAAAAwANABQAAwAAAAAAAAB5eXkpO18oKg4ABQACBAAUAAMAAAAIAAAAO18oQF8p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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD+/wAACgACAAAAAAAAAAAAAAAAAAAAAAABAAAAAtXN1ZwuGxCTlwgAKyz5rjAAAADIAAAACAAAAAEAAABIAAAAFwAAAFAAAAALAAAAWAAAABAAAABgAAAAEwAAAGgAAAAWAAAAcAAAAA0AAAB4AAAADAAAAKQAAAACAAAA5AQAAAMAAAAAABAACwAAAAAAAAALAAAAAAAAAAsAAAAAAAAACwAAAAAAAAAeEAAAAQAAACAAAAAyMDI0MDgxNiBDb250cmFjdCBFbmVyZ3kgQW1vdW50AAwQAAACAAAAHgAAAAsAAABXb3Jrc2hlZXRzAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAAJQAAACYAAAAnAAAA/v///ykAAAAqAAAAKwAAACwAAAAtAAAALgAAAC8AAAD+////MQAAADIAAAAzAAAANAAAADUAAAA2AAAANwAAAP7////9/////v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9SAG8AbwB0ACAARQBuAHQAcgB5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFgAFAf//////////AgAAACAIAgAAAAAAwAAAAAAAAEYAAAAAAAAAAAAAAAAAAAAAAAAAAP7///8AAAAAAAAAAFcAbwByAGsAYgBvAG8AawAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAIB////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOhPAAAAAAAABQBTAHUAbQBtAGEAcgB5AEkAbgBmAG8AcgBtAGEAdABpAG8AbgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAgEBAAAAAwAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAABAAAAAAAAAFAEQAbwBjAHUAbQBlAG4AdABTAHUAbQBtAGEAcgB5AEkAbgBmAG8AcgBtAGEAdABpAG8AbgAAAAAAAAAAAAAAOAACAf///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAEAAAAAAAAA==",
    guid: "b8e5d0e0-61be-4a0d-9aab-a041622f387e",
    name: "Template ContractEnergyAmount.xls",
    type: "application/vnd.ms-excel",
  });

  function downloadTemplateFile() {
    const base64Content = templateFile.binary//.split(",")[1];
    const binaryString = atob(base64Content);
    const binaryLength = binaryString.length;
    const bytes = new Uint8Array(binaryLength);

    for (let i = 0; i < binaryLength; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }

    const blob = new Blob([bytes], { type: templateFile.type });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = templateFile.name;
    link.click();
    URL.revokeObjectURL(link.href);
  }

  console.log("Tumb File", tumbFile);
  const copytoMainFile = () => {
    console.log("FIle in Tumb to Main", allowcatedExcelFileList);
    setTumbFile([]);
    console.log(tumbFile);
  };

  const onClickCloseModal = () => {
    setTumbFile([]);
    onCloseModal();
  };

  const onClickOk = () => {
    console.log("Tumb File", tumbFile);
    console.log("function Ok in Modal");
    console.log("Tumb In UseEffect", tumbFile);
    console.log(tumbFile[0]?.guid);
    setAllowcatedEnergyList([])
    setAllowcatesExcelfileList((prevFileList) => {
      console.log("prevFileList", prevFileList);
      let newFileList = [
        {
          guid: tumbFile[0]?.guid,
          name: tumbFile[0]?.name,
          size: tumbFile[0]?.size,
          type: tumbFile[0]?.type,
          binary: tumbFile[0]?.binary,
        },
      ];
      return newFileList;
    });
    //copytoMainFile()
    console.log(allowcatedExcelFileList);
    //console.log(allowcatedExcelFileList[0].guid)
    //let base64String = allowcatedExcelFileList[0].binary;

    // Remove the header if present (e.g., 'data:application/vnd.ms-excel;base64,')
    const base64Content = tumbFile[0].binary//.split(",")[1];

    // Decode the base64 string to binary
    const binaryString = atob(base64Content);

    // Convert binary string to array buffer
    const len = binaryString.length;
    const bytes = new Uint8Array(len);
    for (let i = 0; i < len; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }

    // Convert array buffer to a binary string
    const arrayBuffer = bytes.buffer;

    // Read the Excel file using XLSX
    const workbook = XLSX.read(arrayBuffer, { type: "array" });

    // Access data from the first sheet
    const firstSheetName = workbook.SheetNames[0];
    const worksheet = workbook.Sheets[firstSheetName];
    const sheetData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

    // Log the sheet data
    //console.log(sheetData);
    checkCreate(sheetData)
    if (sheetData.length >= 3) {
      if(sheetData[1]?.[1] === "Year"||sheetData[1]?.[1] === "Year (A.D.)"){
        const filterYearSheet = sheetData.filter((items) => items[1] > 2100)
        const filterYearSheetEmpty = sheetData.filter((items) => items[1] === undefined)
        if(filterYearSheetEmpty.length === 0){
            if(filterYearSheet.length === 0){
              for(let i = 0;i < sheetData.length;i++){
                if(i>=2){
                  const filterDuplicate = sheetData.filter((items)=>items[1] === sheetData[i]?.[1])
                  if(filterDuplicate.length === 1){
                    if (listData.length === 0) {
                      console.log("Add new");
                      console.log("Items : ",sheetData[i]?.[2])
                      setAllowcatedEnergyList((prevEnergyList) => {
                        console.log("prevFileList", prevEnergyList);
                        let newFileList = [
                          ...prevEnergyList,
                          {
                            
                            allocateType: "CUSTOM",
                            amount01: Number(sheetData[i]?.[2] === undefined?0:isNaN(Number(sheetData[i]?.[2]))?0:sheetData[i]?.[2]%10 === 0?sheetData[i]?.[2]:sheetData[i]?.[2].toFixed(2)),
                            amount02: Number(sheetData[i]?.[3] === undefined?0:isNaN(Number(sheetData[i]?.[3]))?0:sheetData[i]?.[3]%10 === 0?sheetData[i]?.[3]:sheetData[i]?.[3].toFixed(2)),
                            amount03: Number(sheetData[i]?.[4] === undefined?0:isNaN(Number(sheetData[i]?.[4]))?0:sheetData[i]?.[4]%10 === 0?sheetData[i]?.[4]:sheetData[i]?.[4].toFixed(2)),
                            amount04: Number(sheetData[i]?.[5] === undefined?0:isNaN(Number(sheetData[i]?.[5]))?0:sheetData[i]?.[5]%10 === 0?sheetData[i]?.[5]:sheetData[i]?.[5].toFixed(2)),
                            amount05: Number(sheetData[i]?.[6] === undefined?0:isNaN(Number(sheetData[i]?.[6]))?0:sheetData[i]?.[6]%10 === 0?sheetData[i]?.[6]:sheetData[i]?.[6].toFixed(2)),
                            amount06: Number(sheetData[i]?.[7] === undefined?0:isNaN(Number(sheetData[i]?.[7]))?0:sheetData[i]?.[7]%10 === 0?sheetData[i]?.[7]:sheetData[i]?.[7].toFixed(2)),
                            amount07: Number(sheetData[i]?.[8] === undefined?0:isNaN(Number(sheetData[i]?.[8]))?0:sheetData[i]?.[8]%10 === 0?sheetData[i]?.[8]:sheetData[i]?.[8].toFixed(2)),
                            amount08: Number(sheetData[i]?.[9] === undefined?0:isNaN(Number(sheetData[i]?.[9]))?0:sheetData[i]?.[9]%10 === 0?sheetData[i]?.[9]:sheetData[i]?.[9].toFixed(2)),
                            amount09: Number(sheetData[i]?.[10] === undefined?0:isNaN(Number(sheetData[i]?.[10]))?0:sheetData[i]?.[10]%10 === 0?sheetData[i]?.[10]:sheetData[i]?.[10].toFixed(2)),
                            amount10: Number(sheetData[i]?.[11] === undefined?0:isNaN(Number(sheetData[i]?.[11]))?0:sheetData[i]?.[11]%10 === 0?sheetData[i]?.[11]:sheetData[i]?.[11].toFixed(2)),
                            amount11: Number(sheetData[i]?.[12] === undefined?0:isNaN(Number(sheetData[i]?.[12]))?0:sheetData[i]?.[12]%10 === 0?sheetData[i]?.[12]:sheetData[i]?.[12].toFixed(2)),
                            amount12: Number(sheetData[i]?.[13] === undefined?0:isNaN(Number(sheetData[i]?.[13]))?0:sheetData[i]?.[13]%10 === 0?sheetData[i]?.[13]:sheetData[i]?.[13].toFixed(2)),
                            year: Number(sheetData[i]?.[1]),
                          },
                        ];
                        return newFileList;
                      });
                    } else {
                      console.log("have data")
                      const lenghtFilter = listData.filter(
                        (items) => items.year === sheetData[i]?.[1]
                      );
                      //console.log(lenghtFilter)
                      if (lenghtFilter.length === 0) {
                        console.log("Add new Year");
                        setAllowcatedEnergyList((prevEnergyList) => {
                          console.log("prevFileList", prevEnergyList);
                          let newFileList = [
                            ...prevEnergyList,
                            {
                              allocateType: "CUSTOM",
                              amount01: Number(sheetData[i]?.[2] === undefined?0:isNaN(Number(sheetData[i]?.[2]))?0:sheetData[i]?.[2]%10 === 0?sheetData[i]?.[2]:sheetData[i]?.[2].toFixed(2)),
                              amount02: Number(sheetData[i]?.[3] === undefined?0:isNaN(Number(sheetData[i]?.[3]))?0:sheetData[i]?.[3]%10 === 0?sheetData[i]?.[3]:sheetData[i]?.[3].toFixed(2)),
                              amount03: Number(sheetData[i]?.[4] === undefined?0:isNaN(Number(sheetData[i]?.[4]))?0:sheetData[i]?.[4]%10 === 0?sheetData[i]?.[4]:sheetData[i]?.[4].toFixed(2)),
                              amount04: Number(sheetData[i]?.[5] === undefined?0:isNaN(Number(sheetData[i]?.[5]))?0:sheetData[i]?.[5]%10 === 0?sheetData[i]?.[5]:sheetData[i]?.[5].toFixed(2)),
                              amount05: Number(sheetData[i]?.[6] === undefined?0:isNaN(Number(sheetData[i]?.[6]))?0:sheetData[i]?.[6]%10 === 0?sheetData[i]?.[6]:sheetData[i]?.[6].toFixed(2)),
                              amount06: Number(sheetData[i]?.[7] === undefined?0:isNaN(Number(sheetData[i]?.[7]))?0:sheetData[i]?.[7]%10 === 0?sheetData[i]?.[7]:sheetData[i]?.[7].toFixed(2)),
                              amount07: Number(sheetData[i]?.[8] === undefined?0:isNaN(Number(sheetData[i]?.[8]))?0:sheetData[i]?.[8]%10 === 0?sheetData[i]?.[8]:sheetData[i]?.[8].toFixed(2)),
                              amount08: Number(sheetData[i]?.[9] === undefined?0:isNaN(Number(sheetData[i]?.[9]))?0:sheetData[i]?.[9]%10 === 0?sheetData[i]?.[9]:sheetData[i]?.[9].toFixed(2)),
                              amount09: Number(sheetData[i]?.[10] === undefined?0:isNaN(Number(sheetData[i]?.[10]))?0:sheetData[i]?.[10]%10 === 0?sheetData[i]?.[10]:sheetData[i]?.[10].toFixed(2)),
                              amount10: Number(sheetData[i]?.[11] === undefined?0:isNaN(Number(sheetData[i]?.[11]))?0:sheetData[i]?.[11]%10 === 0?sheetData[i]?.[11]:sheetData[i]?.[11].toFixed(2)),
                              amount11: Number(sheetData[i]?.[12] === undefined?0:isNaN(Number(sheetData[i]?.[12]))?0:sheetData[i]?.[12]%10 === 0?sheetData[i]?.[12]:sheetData[i]?.[12].toFixed(2)),
                              amount12: Number(sheetData[i]?.[13] === undefined?0:isNaN(Number(sheetData[i]?.[13]))?0:sheetData[i]?.[13]%10 === 0?sheetData[i]?.[13]:sheetData[i]?.[13].toFixed(2)),
                              year: Number(sheetData[i]?.[1]),
                            },
                          ];
                          return newFileList;
                        });
                      } else {
                        console.log("Update Old Data");
                        const indexFilterList = listData.findIndex(
                          (items) => items.year === sheetData[i]?.[1]
                        );
                        
                        const listTempData = listData;
                        //console.log("List Old",listTempData[indexFilterList])
                        
                        listTempData[indexFilterList] = {
                            allocateType: "CUSTOM",
                            amount01: Number(sheetData[i]?.[2] === undefined?0:isNaN(Number(sheetData[i]?.[2]))?0:sheetData[i]?.[2]%10 === 0?sheetData[i]?.[2]:sheetData[i]?.[2].toFixed(2)),
                            amount02: Number(sheetData[i]?.[3] === undefined?0:isNaN(Number(sheetData[i]?.[3]))?0:sheetData[i]?.[3]%10 === 0?sheetData[i]?.[3]:sheetData[i]?.[3].toFixed(2)),
                            amount03: Number(sheetData[i]?.[4] === undefined?0:isNaN(Number(sheetData[i]?.[4]))?0:sheetData[i]?.[4]%10 === 0?sheetData[i]?.[4]:sheetData[i]?.[4].toFixed(2)),
                            amount04: Number(sheetData[i]?.[5] === undefined?0:isNaN(Number(sheetData[i]?.[5]))?0:sheetData[i]?.[5]%10 === 0?sheetData[i]?.[5]:sheetData[i]?.[5].toFixed(2)),
                            amount05: Number(sheetData[i]?.[6] === undefined?0:isNaN(Number(sheetData[i]?.[6]))?0:sheetData[i]?.[6]%10 === 0?sheetData[i]?.[6]:sheetData[i]?.[6].toFixed(2)),
                            amount06: Number(sheetData[i]?.[7] === undefined?0:isNaN(Number(sheetData[i]?.[7]))?0:sheetData[i]?.[7]%10 === 0?sheetData[i]?.[7]:sheetData[i]?.[7].toFixed(2)),
                            amount07: Number(sheetData[i]?.[8] === undefined?0:isNaN(Number(sheetData[i]?.[8]))?0:sheetData[i]?.[8]%10 === 0?sheetData[i]?.[8]:sheetData[i]?.[8].toFixed(2)),
                            amount08: Number(sheetData[i]?.[9] === undefined?0:isNaN(Number(sheetData[i]?.[9]))?0:sheetData[i]?.[9]%10 === 0?sheetData[i]?.[9]:sheetData[i]?.[9].toFixed(2)),
                            amount09: Number(sheetData[i]?.[10] === undefined?0:isNaN(Number(sheetData[i]?.[10]))?0:sheetData[i]?.[10]%10 === 0?sheetData[i]?.[10]:sheetData[i]?.[10].toFixed(2)),
                            amount10: Number(sheetData[i]?.[11] === undefined?0:isNaN(Number(sheetData[i]?.[11]))?0:sheetData[i]?.[11]%10 === 0?sheetData[i]?.[11]:sheetData[i]?.[11].toFixed(2)),
                            amount11: Number(sheetData[i]?.[12] === undefined?0:isNaN(Number(sheetData[i]?.[12]))?0:sheetData[i]?.[12]%10 === 0?sheetData[i]?.[12]:sheetData[i]?.[12].toFixed(2)),
                            amount12: Number(sheetData[i]?.[13] === undefined?0:isNaN(Number(sheetData[i]?.[13]))?0:sheetData[i]?.[13]%10 === 0?sheetData[i]?.[13]:sheetData[i]?.[13].toFixed(2)),
                            year: Number(sheetData[i]?.[1]),
                        };
                        setAllowcatedEnergyList(listTempData);
                      }
                    }
                  }
                  else{
                    setIsShowFailModal(true)
                    setMessageFailModal("Please check file data again have year is duplicate.")
                    setAllowcatesExcelfileList([])
                    setTumbFile([]);
                    onCloseModal();
                    break;
                  }
                }
              }
            /*sheetData.map((item, index) => {
            if (index >= 2) {
              console.log("Items", item);
                if (listData.length === 0) {
                  console.log("Add new");
                  console.log("Items : ",item[2])
                  setAllowcatedEnergyList((prevEnergyList) => {
                    console.log("prevFileList", prevEnergyList);
                    let newFileList = [
                      ...prevEnergyList,
                      {
                        
                        allocateType: "CUSTOM",
                        amount01: Number(item[2] === undefined?0:isNaN(Number(item[2]))?0:item[2]%10 === 0?item[2]:item[2].toFixed(2)),
                        amount02: Number(item[3] === undefined?0:isNaN(Number(item[3]))?0:item[3]%10 === 0?item[3]:item[3].toFixed(2)),
                        amount03: Number(item[4] === undefined?0:isNaN(Number(item[4]))?0:item[4]%10 === 0?item[4]:item[4].toFixed(2)),
                        amount04: Number(item[5] === undefined?0:isNaN(Number(item[5]))?0:item[5]%10 === 0?item[5]:item[5].toFixed(2)),
                        amount05: Number(item[6] === undefined?0:isNaN(Number(item[6]))?0:item[6]%10 === 0?item[6]:item[6].toFixed(2)),
                        amount06: Number(item[7] === undefined?0:isNaN(Number(item[7]))?0:item[7]%10 === 0?item[7]:item[7].toFixed(2)),
                        amount07: Number(item[8] === undefined?0:isNaN(Number(item[8]))?0:item[8]%10 === 0?item[8]:item[8].toFixed(2)),
                        amount08: Number(item[9] === undefined?0:isNaN(Number(item[9]))?0:item[9]%10 === 0?item[9]:item[9].toFixed(2)),
                        amount09: Number(item[10] === undefined?0:isNaN(Number(item[10]))?0:item[10]%10 === 0?item[10]:item[10].toFixed(2)),
                        amount10: Number(item[11] === undefined?0:isNaN(Number(item[11]))?0:item[11]%10 === 0?item[11]:item[11].toFixed(2)),
                        amount11: Number(item[12] === undefined?0:isNaN(Number(item[12]))?0:item[12]%10 === 0?item[12]:item[12].toFixed(2)),
                        amount12: Number(item[13] === undefined?0:isNaN(Number(item[13]))?0:item[13]%10 === 0?item[13]:item[13].toFixed(2)),
                        year: Number(item[1]),
                      },
                    ];
                    return newFileList;
                  });
                } else {
                  console.log("have data")
                  const lenghtFilter = listData.filter(
                    (items) => items.year === item[1]
                  );
                  //console.log(lenghtFilter)
                  if (lenghtFilter.length === 0) {
                    console.log("Add new Year");
                    setAllowcatedEnergyList((prevEnergyList) => {
                      console.log("prevFileList", prevEnergyList);
                      let newFileList = [
                        ...prevEnergyList,
                        {
                          allocateType: "CUSTOM",
                          amount01: Number(item[2] === undefined?0:isNaN(Number(item[2]))?0:item[2]%10 === 0?item[2]:item[2].toFixed(2)),
                          amount02: Number(item[3] === undefined?0:isNaN(Number(item[3]))?0:item[3]%10 === 0?item[3]:item[3].toFixed(2)),
                          amount03: Number(item[4] === undefined?0:isNaN(Number(item[4]))?0:item[4]%10 === 0?item[4]:item[4].toFixed(2)),
                          amount04: Number(item[5] === undefined?0:isNaN(Number(item[5]))?0:item[5]%10 === 0?item[5]:item[5].toFixed(2)),
                          amount05: Number(item[6] === undefined?0:isNaN(Number(item[6]))?0:item[6]%10 === 0?item[6]:item[6].toFixed(2)),
                          amount06: Number(item[7] === undefined?0:isNaN(Number(item[7]))?0:item[7]%10 === 0?item[7]:item[7].toFixed(2)),
                          amount07: Number(item[8] === undefined?0:isNaN(Number(item[8]))?0:item[8]%10 === 0?item[8]:item[8].toFixed(2)),
                          amount08: Number(item[9] === undefined?0:isNaN(Number(item[9]))?0:item[9]%10 === 0?item[9]:item[9].toFixed(2)),
                          amount09: Number(item[10] === undefined?0:isNaN(Number(item[10]))?0:item[10]%10 === 0?item[10]:item[10].toFixed(2)),
                          amount10: Number(item[11] === undefined?0:isNaN(Number(item[11]))?0:item[11]%10 === 0?item[11]:item[11].toFixed(2)),
                          amount11: Number(item[12] === undefined?0:isNaN(Number(item[12]))?0:item[12]%10 === 0?item[12]:item[12].toFixed(2)),
                          amount12: Number(item[13] === undefined?0:isNaN(Number(item[13]))?0:item[13]%10 === 0?item[13]:item[13].toFixed(2)),
                          year: Number(item[1]),
                        },
                      ];
                      return newFileList;
                    });
                  } else {
                    console.log("Update Old Data");
                    const indexFilterList = listData.findIndex(
                      (items) => items.year === item[1]
                    );
                    
                    const listTempData = listData;
                    //console.log("List Old",listTempData[indexFilterList])
                    
                    listTempData[indexFilterList] = {
                      allocateType: "CUSTOM",
                      amount01: Number(item[2] === undefined?0:isNaN(Number(item[2]))?0:item[2]%10 === 0?item[2]:item[2].toFixed(2)),
                      amount02: Number(item[3] === undefined?0:isNaN(Number(item[3]))?0:item[3]%10 === 0?item[3]:item[3].toFixed(2)),
                      amount03: Number(item[4] === undefined?0:isNaN(Number(item[4]))?0:item[4]%10 === 0?item[4]:item[4].toFixed(2)),
                      amount04: Number(item[5] === undefined?0:isNaN(Number(item[5]))?0:item[5]%10 === 0?item[5]:item[5].toFixed(2)),
                      amount05: Number(item[6] === undefined?0:isNaN(Number(item[6]))?0:item[6]%10 === 0?item[6]:item[6].toFixed(2)),
                      amount06: Number(item[7] === undefined?0:isNaN(Number(item[7]))?0:item[7]%10 === 0?item[7]:item[7].toFixed(2)),
                      amount07: Number(item[8] === undefined?0:isNaN(Number(item[8]))?0:item[8]%10 === 0?item[8]:item[8].toFixed(2)),
                      amount08: Number(item[9] === undefined?0:isNaN(Number(item[9]))?0:item[9]%10 === 0?item[9]:item[9].toFixed(2)),
                      amount09: Number(item[10] === undefined?0:isNaN(Number(item[10]))?0:item[10]%10 === 0?item[10]:item[10].toFixed(2)),
                      amount10: Number(item[11] === undefined?0:isNaN(Number(item[11]))?0:item[11]%10 === 0?item[11]:item[11].toFixed(2)),
                      amount11: Number(item[12] === undefined?0:isNaN(Number(item[12]))?0:item[12]%10 === 0?item[12]:item[12].toFixed(2)),
                      amount12: Number(item[13] === undefined?0:isNaN(Number(item[13]))?0:item[13]%10 === 0?item[13]:item[13].toFixed(2)),
                      year: Number(item[1]),
                    };
                    setAllowcatedEnergyList(listTempData);
                  }
                }
            }
            });*/
            setTumbFile([]);
            onCloseModal();
            }
            else{
              //message.error("Please check file data is not match and try again.")
              setIsShowFailModal(true)
              setMessageFailModal("Please check file data is not match and try again.")
              setAllowcatesExcelfileList([])
              setTumbFile([]);
              onCloseModal();
            }
        }
        else{
          //message.error("Please check file data again year is empty.")
          setIsShowFailModal(true)
          setMessageFailModal("Please check file data again year is empty.")
          setAllowcatesExcelfileList([])
          setTumbFile([]);
          onCloseModal();
        }
        
      }
      else{
        //message.error("Please check file data is not match and try again.")
        setIsShowFailModal(true)
        setMessageFailModal("Please check file data is not match and try again.")
        setAllowcatesExcelfileList([])
        setTumbFile([]);
        onCloseModal();
      }
    } else {
      //message.error("This file didn't have data to add.");
      setIsShowFailModal(true)
      setMessageFailModal("This file didn't have data to add.")
    }
  };

  const checkCreate=(data)=>{
    console.log("Come to function check")
      const diffYear = (yearEnd-yearStart)+1
      const lengthData = data.length-2
      console.log("Data",data)
      const lengthCreateStartyear = data.filter((items)=> items[1] === yearStart)
      const lenghtCreateEndyear = data.filter((items)=>items[1] === yearEnd)
      console.log("Diff Year",diffYear)
      console.log("Data length",lengthData)
      console.log(lengthCreateStartyear.length)
      console.log(lenghtCreateEndyear.length)

      if(lengthCreateStartyear.length !== 0){
        console.log("Have Start Year")
        if(lenghtCreateEndyear.length !== 0){
          console.log("Have End Year")
          if(lengthData < diffYear){
            console.log("Length is not match")
            setIsShowFailModal(true)
            setMessageFailModal("Data upload file is not match with Retail ESA Contract Start Date and Retail ESA Contract End Date")
          }
        }
        else{
          console.log("Dont have end")
            setIsShowFailModal(true)
            setMessageFailModal("Data upload file is not match with Retail ESA Contract Start Date and Retail ESA Contract End Date")
        }
      }
      else{
        console.log("Dont have start")
        setIsShowFailModal(true)
        setMessageFailModal("Data upload file is not match with Retail ESA Contract Start Date and Retail ESA Contract End Date")
      }
  }

  const getButtonColor = () => {
    switch (buttonTypeColor) {
      case "primary":
        return "bg-[#87BE33]";
      case "danger":
        return "bg-[#EF4835]";

      default:
        return "bg-[#87BE33]";
    }
  };
  function generateGUID() {
    return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(
      /[xy]/g,
      function (c) {
        const r = (Math.random() * 16) | 0,
          v = c === "x" ? r : (r & 0x3) | 0x8;
        return v.toString(16);
      }
    );
  }

  const handleUploadfileExcel = async (id, result) => {
    // console.log("fileJaa>>>",file)
    console.log("Result", result);
    console.log("----Excel FIle---", allowcatedExcelFileList);
    console.log("Lenght Excel", allowcatedExcelFileList.length);
    console.log(id);
    const reader = new FileReader();
    reader.onload = function (e) {
      const arrayBuffer = e.target.result;
      
      console.log("Binary data as ArrayBuffer:", arrayBuffer);
      const base64Content = arrayBuffer.split(",")[1];
      console.log(base64Content)
      let guid = generateGUID();
      setTumbFile((prevFileList) => {
        console.log("prevFileList", prevFileList);
        let newFileList = [
          ...prevFileList,
          {
            guid: "",
            name: result?.name,
            size: result?.size,
            type: result?.type,
            binary: base64Content,
          },
        ];
        return newFileList;
      });
    };

    console.log(allowcatedExcelFileList);

    let bi = reader.readAsDataURL(result);

    /*console.log("id", id);
        console.log("res", result);
        console.log("file=>>", result?.res["@id"]);
    
        setFileListExcel((prevFileList) => {
          console.log("prevFileList", prevFileList);
          let newFileList = [
            ...prevFileList,
            { fileID: result?.res?.uid, evidentFileID: result?.res["@id"] },
          ];
          return newFileList;
        });*/
  };

  const handleDeleteFileExcel = (id, evidentFileID, fileName) => {
    // console.log('id>>',id)
    console.log("evidentFileID>>", evidentFileID);
    /*setAllowcatesExcelfileList((prevFileList) => {
      console.log("prevFileList", prevFileList);
      let newFileList = prevFileList.filter(
        (item) => item.name !== evidentFileID
      );
      return newFileList;
    });*/
    setTumbFile([])
  };

  const handleClickDownloadFileExcel = async (item) => {
    // console.log('item',item)
    // console.log('item evidentFileID',item?.evidentFileID)
    // console.log('item name',item?.name)
    try {
      // setIsOpenLoading(true);
      showLoading();
      console.log("Download File");
      const fileID = item?.guid;
      const fileName = item?.name;
      const binary = item?.binary;
      const requestParameter = {
        fileID: fileID,
        fileName: fileName,
      };
      //const response = await FetchDownloadFile(requestParameter);

      //const blob = new Blob([response.res.data], {
      //type: response.res.headers["content-type"],
      //});
      // Create a download link
      //const url = window.URL.createObjectURL(blob);
      //const a = document.createElement("a");
      //a.href = url;
      //a.download = fileName;
      //document.body.appendChild(a);
      //a.click();
      //document.body.removeChild(a);
      //window.URL.revokeObjectURL(url);
    } catch (error) {
      //  console.error("Error downloading file:", error);
    }
    hideLoading();
    // setIsOpenLoading(false);
  };

  return (
    <Modal
      size="xl"
      opened={true}
      onClose={() => onClickOk && onClickOk(false)}
      withCloseButton={false}
      closeOnClickOutside={false}
      centered
    >
      {/* <div className="pt-4 px-4 pb-2">
        <h6 className="text-PRIMARY_TEXT font-semibold">
          Allocated energy amount
        </h6>
        </div>*/}
      <Controller
        name="uploadFileExcel"
        control={control}
        rules={{
          required: "This field is required",
        }}
        render={({ field }) => (
          <UploadFileSubscriber
            {...field}
            id={"uploadFileExcel"}
            type={"file"}
            multiple={false}
            accept={".xls,.xlsx"}
            label={"Contracted Energy Amount"}
            onChngeInput={(id, res) => {
              handleUploadfileExcel(id, res);
            }}
            onDeleteFile={(id, evidentFileID, fileName) => {
              handleDeleteFileExcel(id, evidentFileID, fileName);
            }}
            onClickFile={(item) => {
              handleClickDownloadFileExcel(item);
            }}
            error={errors.uploadFileExcel}
            validate={" *"}
            disabled={tumbFile.length !== 0 ?true:false}
            // ... other props
          />
        )}
      />
      <div className="grow bg-lime-200 mt-2 w-full">
        <div className="flex justify-content items-center">
          <div className="mr-8"></div>
          <label className="text-sm font-normal">
            Download Template File :
          </label>
          <div>
            <label
              style={{ cursor: "pointer", color: "blue" }}
              className="text-sm font-normal ml-1"
              onClick={downloadTemplateFile}
            >
              {templateFile.name}
            </label>
          </div>
        </div>
      </div>
      <div className="flex justify-center gap-3 p-2 mt-4">
        <button
          onClick={onCloseModal}
          className="w-25 rounded shadow-sm px-4 py-2 font-normal bg-[#EFEFEF] hover:bg-[#78829D] hover:text-white"
        >
          Cancel
        </button>
        <button
          onClick={handleSubmit(onClickOk)}
          className={`${getButtonColor()} w-25 rounded shadow-sm px-4 py-2 font-semibold text-white sm:text-sm hover:bg-[#4D6A00] `}
        >
          Import
        </button>
      </div>
    </Modal>
  );
}
